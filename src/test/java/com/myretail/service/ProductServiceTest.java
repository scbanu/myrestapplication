package com.myretail.service;

import static org.junit.Assert.assertEquals;

import java.util.Collections;
import java.util.List;

import org.json.JSONException;
import org.junit.After;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;
import org.skyscreamer.jsonassert.JSONAssert;

import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.myretail.service.beans.Product2Display;
import com.myretail.utils.MyJSONComparator;

public class ProductServiceTest {

	@BeforeClass
	public static void setUpBeforeClass() throws Exception {
	}

	@AfterClass
	public static void tearDownAfterClass() throws Exception {
	}

	@Before
	public void setUp() throws Exception {
	}

	@After
	public void tearDown() throws Exception {
	}

	@Test
	public void testGetProductDetails() {
		assertEquals(1, 1);
	}

	@Test
	public void testExtractProductsSuccess() throws JsonParseException, JsonMappingException, JSONException {
		
		//String jsonString = "{\"productId\":\"3525081\",\"type\":\"product\",\"title\":\"hush Marble Panel Maxi Dress, Multi\",\"code\":\"44452504\",\"averageRating\":4.2083,\"reviews\":24,\"price\":{\"was\":\"\",\"then1\":\"\",\"then2\":\"\",\"now\":\"59.00\",\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519451?\",\"additionalServices\":[],\"displaySpecialOffer\":\"Exclusive to John Lewis & hush\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"\",\"customPromotionalMessage\":\"Exclusive to John Lewis & hush\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237494272\",\"ColorSwatches\":[],\"colorSwatchSelected\":0,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"hush\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"washinginstructions\":\"Machine washable\",\"dressbyoccasion\":\"Weekend\",\"dressshape\":\"Straight\",\"typeofpattern\":\"Pattern\"},\"directorate\":\"Fashion Directorate\",\"releaseDateTimestamp\":0}";
		String jsonString = "{\"showInStockOnly\":\"\",\"products\":[{\"productId\":\"3341058\",\"type\":\"product\",\"title\":\"Jolie Moi Bonded Lace Prom Dress\",\"code\":\"69251715\",\"averageRating\":0,\"reviews\":0,\"price\":{\"was\":\"85.00\",\"then1\":\"68.00\",\"then2\":\"\",\"now\":{\"from\":\"59.00\",\"to\":\"68.00\"},\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335080?\",\"additionalServices\":[],\"displaySpecialOffer\":\"Reduced to clear\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"Reduced to clear\",\"customPromotionalMessage\":\"Online only\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237169219\",\"colorSwatches\":[{\"color\":\"Dark Grey\",\"basicColor\":\"Grey\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335106alt4?cropN=0.56,0.6989473684210527,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335106?\",\"isAvailable\":false,\"skuId\":\"237169362\"},{\"color\":\"Dark Mauve\",\"basicColor\":\"Purple\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335107alt4?cropN=0.6063157894736843,0.631578947368421,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335107?\",\"isAvailable\":true,\"skuId\":\"237169364\"},{\"color\":\"Dark Teal\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335109alt3?cropN=0.4652631578947368,0.15578947368421053,0.08210526315789474,0.08210526315789474&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335109?\",\"isAvailable\":true,\"skuId\":\"237169370\"},{\"color\":\"Berry\",\"basicColor\":\"Purple\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335080alt4?cropN=0.42526315789473684,0.5957894736842105,0.3031578947368421,0.3031578947368421&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335080?\",\"isAvailable\":true,\"skuId\":\"237169205\"},{\"color\":\"Burgundy\",\"basicColor\":\"Red\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335090?cropN=0.42105263157894735,0.42105263157894735,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335090?\",\"isAvailable\":false,\"skuId\":\"237169270\"},{\"color\":\"Navy\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335141?cropN=0.42105263157894735,0.42105263157894735,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335141?\",\"isAvailable\":true,\"skuId\":\"237169572\"},{\"color\":\"Royal Blue\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335151alt3?cropN=0.42105263157894735,0.5810526315789474,0.40421052631578946,0.40421052631578946&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335151?\",\"isAvailable\":true,\"skuId\":\"237169620\"}],\"colorSwatchSelected\":3,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"Jolie Moi\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"washinginstructions\":\"Dry clean only\",\"dressbyoccasion\":\"Wedding Guest\",\"dressshape\":\"Flared\",\"fabric\":\"Lace\"},\"directorate\":\"Fashion Directorate\",\"releaseDateTimestamp\":0},{\"productId\":\"3525085\",\"type\":\"product\",\"title\":\"hushTashaVestDress\",\"code\":\"44452455\",\"averageRating\":4.5417,\"reviews\":24,\"price\":{\"was\":\"\",\"then1\":\"\",\"then2\":\"\",\"now\":\"55.00\",\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519508?\",\"additionalServices\":[],\"displaySpecialOffer\":\"ExclusivetoJohnLewis&hush\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"\",\"customPromotionalMessage\":\"ExclusivetoJohnLewis&hush\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237494601\",\"colorSwatches\":[{\"color\":\"Wine\",\"basicColor\":\"Red\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519508alt4?cropN=0.5073684210526316,0.23789473684210527,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519508?\",\"isAvailable\":true,\"skuId\":\"237494589\"},{\"color\":\"Midnight\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519502?cropN=0.42105263157894735,0.42105263157894735,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519502?\",\"isAvailable\":false,\"skuId\":\"237494562\"}],\"colorSwatchSelected\":0,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"hush\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"washinginstructions\":\"Machinewashable\",\"dressbyoccasion\":\"Holiday\",\"dressshape\":\"Shift\",\"typeofpattern\":\"Plain\"},\"directorate\":\"FashionDirectorate\",\"releaseDateTimestamp\":0}],\"facets\":[{\"dimensionName\":\"sku.offerType\",\"name\":\"OnOffer\",\"type\":\"Multi\",\"tooltip\":\"\",\"details\":[{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/reduced-to-clear/_/N-flwZ1yzwd58\",\"label\":\"ReducedToClear\",\"qty\":\"2688\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"},{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/all-offers/_/N-flwZ1yzvw1q\",\"label\":\"AllOffers\",\"qty\":\"2688\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"}]},{\"dimensionName\":\"brand\",\"name\":\"Brand\",\"type\":\"Multi\",\"tooltip\":\"\",\"details\":[{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/adrianna-papell/_/N-flwZ1z13u5h\",\"label\":\"AdriannaPapell\",\"qty\":\"431\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"},{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/allsaints/_/N-flwZ1z0g0g6\",\"label\":\"AllSaints\",\"qty\":\"78\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"},{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/yumi-curves/_/N-flwZ1z00d6n\",\"label\":\"YumiCurves\",\"qty\":\"31\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"}]}],\"categoryTitle\":\"Women'sDresses\",\"childCategoriesCount\":0,\"seoInformation\":{\"title\":\"Dresses|MaxiDresses,SummerandEveningDresses|JohnLewis\",\"description\":\"Shopwomen'sdressesonline.FromSummerdressesandpartydressestoMaxidressesandeveningdresses,plusmanymoreshapesandstyles.\"},\"results\":5648,\"pagesAvailable\":113,\"crumbs\":[{\"type\":\"CATALOGUE\",\"displayName\":\"Women\",\"item\":\"50000298\",\"clickable\":\"true\"},{\"type\":\"CATALOGUE\",\"displayName\":\"Women'sClothing-NCH\",\"item\":\"190118298\",\"clickable\":\"true\"},{\"type\":\"CATALOGUE\",\"displayName\":\"Women'sDresses\",\"item\":\"600001506\",\"clickable\":\"false\"}],\"dynamicBannerId\":\"\",\"seoBannerId\":\"womens-dresses-seo-120218\",\"redirectUrl\":\"\",\"staticLinks\":[],\"selectedDept\":\"women||fje\",\"multiCatSelected\":\"false\",\"endecaCanonical\":\"/women/womens-clothing-nch/womens-dresses/_/N-flw\"}";
		ProductService productService = new ProductService();
		List<Product2Display> products = productService.extractProducts(jsonString, null);
		Collections.sort(products, new MyJSONComparator());
		Collections.reverse(products);
		
		Gson gsonBuilder = new GsonBuilder().create();
		String jsonFromJavaArrayList = gsonBuilder.toJson(products);

		String expected = "[{\"productId\":\"3341058\",\"nowPrice\":\"£59.00\",\"title\":\"Jolie Moi Bonded Lace Prom Dress\",\"colorSwatches\":[{\"color\":\"Dark Grey\",\"rgbColor\":\"#808080\",\"skuId\":\"237169362\",\"additionalProperties\":{}},{\"color\":\"Dark Mauve\",\"rgbColor\":\"#800080\",\"skuId\":\"237169364\",\"additionalProperties\":{}},{\"color\":\"Dark Teal\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237169370\",\"additionalProperties\":{}},{\"color\":\"Berry\",\"rgbColor\":\"#800080\",\"skuId\":\"237169205\",\"additionalProperties\":{}},{\"color\":\"Burgundy\",\"rgbColor\":\"#ff0000\",\"skuId\":\"237169270\",\"additionalProperties\":{}},{\"color\":\"Navy\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237169572\",\"additionalProperties\":{}},{\"color\":\"Royal Blue\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237169620\",\"additionalProperties\":{}}],\"priceLabel\":\"Was £85.00, now £59.00\",\"disocunt\":30.59,\"additionalProperties\":{}},{\"productId\":\"3525085\",\"nowPrice\":\"£55.00\",\"title\":\"hushTashaVestDress\",\"colorSwatches\":[{\"color\":\"Wine\",\"rgbColor\":\"#ff0000\",\"skuId\":\"237494589\",\"additionalProperties\":{}},{\"color\":\"Midnight\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237494562\",\"additionalProperties\":{}}],\"priceLabel\":\"Was £.00, now £55.00\",\"disocunt\":0.0,\"additionalProperties\":{}}]"; 
		JSONAssert.assertEquals(expected, jsonFromJavaArrayList, false);
	}

	@Test
	public void testExtractProductsFailure() throws JsonParseException, JsonMappingException, JSONException {
		
		String jsonString = "{\"showInStockOnly\":\"\",\"products\":[{\"productId\":\"3341058\",\"type\":\"product\",\"title\":\"Jolie Moi Bonded Lace Prom Dress\",\"code\":\"69251715\",\"averageRating\":0,\"reviews\":0,\"price\":{\"was\":\"85.00\",\"then1\":\"68.00\",\"then2\":\"\",\"now\":{\"from\":\"59.00\",\"to\":\"68.00\"},\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335080?\",\"additionalServices\":[],\"displaySpecialOffer\":\"Reduced to clear\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"Reduced to clear\",\"customPromotionalMessage\":\"Online only\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237169219\",\"colorSwatches\":[{\"color\":\"Dark Grey\",\"basicColor\":\"Grey\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335106alt4?cropN=0.56,0.6989473684210527,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335106?\",\"isAvailable\":false,\"skuId\":\"237169362\"},{\"color\":\"Dark Mauve\",\"basicColor\":\"Purple\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335107alt4?cropN=0.6063157894736843,0.631578947368421,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335107?\",\"isAvailable\":true,\"skuId\":\"237169364\"},{\"color\":\"Dark Teal\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335109alt3?cropN=0.4652631578947368,0.15578947368421053,0.08210526315789474,0.08210526315789474&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335109?\",\"isAvailable\":true,\"skuId\":\"237169370\"},{\"color\":\"Berry\",\"basicColor\":\"Purple\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335080alt4?cropN=0.42526315789473684,0.5957894736842105,0.3031578947368421,0.3031578947368421&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335080?\",\"isAvailable\":true,\"skuId\":\"237169205\"},{\"color\":\"Burgundy\",\"basicColor\":\"Red\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335090?cropN=0.42105263157894735,0.42105263157894735,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335090?\",\"isAvailable\":false,\"skuId\":\"237169270\"},{\"color\":\"Navy\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335141?cropN=0.42105263157894735,0.42105263157894735,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335141?\",\"isAvailable\":true,\"skuId\":\"237169572\"},{\"color\":\"Royal Blue\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335151alt3?cropN=0.42105263157894735,0.5810526315789474,0.40421052631578946,0.40421052631578946&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003335151?\",\"isAvailable\":true,\"skuId\":\"237169620\"}],\"colorSwatchSelected\":3,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"Jolie Moi\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"washinginstructions\":\"Dry clean only\",\"dressbyoccasion\":\"Wedding Guest\",\"dressshape\":\"Flared\",\"fabric\":\"Lace\"},\"directorate\":\"Fashion Directorate\",\"releaseDateTimestamp\":0},{\"productId\":\"3525085\",\"type\":\"product\",\"title\":\"hushTashaVestDress\",\"code\":\"44452455\",\"averageRating\":4.5417,\"reviews\":24,\"price\":{\"was\":\"\",\"then1\":\"\",\"then2\":\"\",\"now\":\"55.00\",\"uom\":\"\",\"currency\":\"GBP\"},\"image\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519508?\",\"additionalServices\":[],\"displaySpecialOffer\":\"ExclusivetoJohnLewis&hush\",\"promoMessages\":{\"priceMatched\":\"\",\"offer\":\"\",\"customPromotionalMessage\":\"ExclusivetoJohnLewis&hush\",\"bundleHeadline\":\"\",\"customSpecialOffer\":{}},\"nonPromoMessage\":\"\",\"defaultSkuId\":\"237494601\",\"colorSwatches\":[{\"color\":\"Wine\",\"basicColor\":\"Red\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519508alt4?cropN=0.5073684210526316,0.23789473684210527,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519508?\",\"isAvailable\":true,\"skuId\":\"237494589\"},{\"color\":\"Midnight\",\"basicColor\":\"Blue\",\"colorSwatchUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519502?cropN=0.42105263157894735,0.42105263157894735,0.16842105263157894,0.16842105263157894&\",\"imageUrl\":\"//johnlewis.scene7.com/is/image/JohnLewis/003519502?\",\"isAvailable\":false,\"skuId\":\"237494562\"}],\"colorSwatchSelected\":0,\"colorWheelMessage\":\"\",\"outOfStock\":false,\"emailMeWhenAvailable\":false,\"availabilityMessage\":\"\",\"compare\":false,\"fabric\":\"\",\"swatchAvailable\":false,\"categoryQuickViewEnabled\":true,\"swatchCategoryType\":\"\",\"brand\":\"hush\",\"ageRestriction\":0,\"isInStoreOnly\":false,\"isMadeToMeasure\":false,\"isBundle\":false,\"isProductSet\":false,\"promotionalFeatures\":[],\"features\":[],\"dynamicAttributes\":{\"newinproducttype\":\"Dresses\",\"washinginstructions\":\"Machinewashable\",\"dressbyoccasion\":\"Holiday\",\"dressshape\":\"Shift\",\"typeofpattern\":\"Plain\"},\"directorate\":\"FashionDirectorate\",\"releaseDateTimestamp\":0}],\"facets\":[{\"dimensionName\":\"sku.offerType\",\"name\":\"OnOffer\",\"type\":\"Multi\",\"tooltip\":\"\",\"details\":[{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/reduced-to-clear/_/N-flwZ1yzwd58\",\"label\":\"ReducedToClear\",\"qty\":\"2688\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"},{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/all-offers/_/N-flwZ1yzvw1q\",\"label\":\"AllOffers\",\"qty\":\"2688\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"}]},{\"dimensionName\":\"brand\",\"name\":\"Brand\",\"type\":\"Multi\",\"tooltip\":\"\",\"details\":[{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/adrianna-papell/_/N-flwZ1z13u5h\",\"label\":\"AdriannaPapell\",\"qty\":\"431\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"},{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/allsaints/_/N-flwZ1z0g0g6\",\"label\":\"AllSaints\",\"qty\":\"78\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"},{\"facetId\":\"/women/womens-clothing-nch/womens-dresses/yumi-curves/_/N-flwZ1z00d6n\",\"label\":\"YumiCurves\",\"qty\":\"31\",\"color\":\"\",\"colorSwatchUrl\":\"\",\"isSelected\":\"false\",\"seoUrlParts\":\"\"}]}],\"categoryTitle\":\"Women'sDresses\",\"childCategoriesCount\":0,\"seoInformation\":{\"title\":\"Dresses|MaxiDresses,SummerandEveningDresses|JohnLewis\",\"description\":\"Shopwomen'sdressesonline.FromSummerdressesandpartydressestoMaxidressesandeveningdresses,plusmanymoreshapesandstyles.\"},\"results\":5648,\"pagesAvailable\":113,\"crumbs\":[{\"type\":\"CATALOGUE\",\"displayName\":\"Women\",\"item\":\"50000298\",\"clickable\":\"true\"},{\"type\":\"CATALOGUE\",\"displayName\":\"Women'sClothing-NCH\",\"item\":\"190118298\",\"clickable\":\"true\"},{\"type\":\"CATALOGUE\",\"displayName\":\"Women'sDresses\",\"item\":\"600001506\",\"clickable\":\"false\"}],\"dynamicBannerId\":\"\",\"seoBannerId\":\"womens-dresses-seo-120218\",\"redirectUrl\":\"\",\"staticLinks\":[],\"selectedDept\":\"women||fje\",\"multiCatSelected\":\"false\",\"endecaCanonical\":\"/women/womens-clothing-nch/womens-dresses/_/N-flw\"}";
		ProductService productService = new ProductService();
		List<Product2Display> products = productService.extractProducts(jsonString, null);
		Collections.sort(products, new MyJSONComparator());
		Collections.reverse(products);
		
		Gson gsonBuilder = new GsonBuilder().create();
		String jsonFromJavaArrayList = gsonBuilder.toJson(products);
		
		String expected = "[{\"asdfasd\":\"3341058\",\"nowPrice\":\"£59.00\",\"title\":\"Jolie Moi Bonded Lace Prom Dress\",\"colorSwatches\":[{\"color\":\"Dark Grey\",\"rgbColor\":\"#808080\",\"skuId\":\"237169362\",\"additionalProperties\":{}},{\"color\":\"Dark Mauve\",\"rgbColor\":\"#800080\",\"skuId\":\"237169364\",\"additionalProperties\":{}},{\"color\":\"Dark Teal\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237169370\",\"additionalProperties\":{}},{\"color\":\"Berry\",\"rgbColor\":\"#800080\",\"skuId\":\"237169205\",\"additionalProperties\":{}},{\"color\":\"Burgundy\",\"rgbColor\":\"#ff0000\",\"skuId\":\"237169270\",\"additionalProperties\":{}},{\"color\":\"Navy\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237169572\",\"additionalProperties\":{}},{\"color\":\"Royal Blue\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237169620\",\"additionalProperties\":{}}],\"priceLabel\":\"Was £85.00, now £59.00\",\"disocunt\":30.59,\"additionalProperties\":{}},{\"productId\":\"3525085\",\"nowPrice\":\"£55.00\",\"title\":\"hushTashaVestDress\",\"colorSwatches\":[{\"color\":\"Wine\",\"rgbColor\":\"#ff0000\",\"skuId\":\"237494589\",\"additionalProperties\":{}},{\"color\":\"Midnight\",\"rgbColor\":\"#0000ff\",\"skuId\":\"237494562\",\"additionalProperties\":{}}],\"priceLabel\":\"Was £.00, now £55.00\",\"disocunt\":0.0,\"additionalProperties\":{}}]"; 
		JSONAssert.assertNotEquals(expected, jsonFromJavaArrayList, false);
	}

	
}
